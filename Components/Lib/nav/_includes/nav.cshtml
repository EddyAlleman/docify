---
name_attribute: title
home_menu: true
menu:
---
@using RazorLight
@using System
@using System.Linq
@using System.Collections.Generic
@using Xarial.Docify.Core.Compiler.Context
@using Components.Shared
@inherits TemplatePage<Xarial.Docify.Core.Compiler.Context.IncludeContextModel>
@{
    const string MENU_OPT = "menu";
    const string HOME_MENU_OPT = "home_menu";

    var menu = NavigationMenuHelper.BuildPredefinedMenu(MENU_OPT, Model.Site, Model.Data)?.ToList();

    if (menu == null)
    {
        menu = Model.Site.MainPage.SubPages.ToList();

        if (Model.Data.GetOrDefault<bool>(HOME_MENU_OPT)) 
        {
            menu.Insert(0, NavigationMenuHelper.BuildPage(Model.Site.MainPage, Model.Data, "Home"));
        }
    }

    string RenderMenu(IEnumerable<IContextPage> pages)
    {
        var html = new System.Text.StringBuilder();

        foreach (var menuPage in pages)
        {
            html.AppendLine("<li class=\"menu-item\">");
            html.AppendLine($"<a href=\"{menuPage.Url}\">{NavigationMenuHelper.GetTitle(menuPage, Model.Data)}</a>");

            if (menuPage.SubPages.Any())
            {
                html.AppendLine("<ul class=\"sub-menu-item-container\">");
                html.AppendLine(@RenderMenu(menuPage.SubPages));
                html.AppendLine("</ul>");
            }
            html.AppendLine("</li>");
        }

        return html.ToString();
    }
}

<ul class="menu sub-menu-item-container" id="top-menu">
    <a class="menu-icon" onclick="OpenMenu(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
    @Raw(RenderMenu(menu))
</ul>
