---
traking_code:
production_only: true
---
@using RazorLight
@using System
@inherits TemplatePage<Xarial.Docify.Core.Compiler.Context.IncludeContextModel>
@{
    string trackingCode = "";

    var enable = Model.Data.Get<bool>("production_only") ? Model.Site.Configuration.Environment == Xarial.Docify.Base.Environment_e.Production : true;

    if (enable)
    {
        trackingCode = Model.Data.GetOrDefault<string>("traking_code");

        if (string.IsNullOrEmpty(trackingCode))
        {
            throw new NullReferenceException("Specify the tracking code for google analytics via 'google_analytics' parameter in the configuration file");
        }
    }
}
@if (enable)
{
    <script async src="https://www.googletagmanager.com/gtag/js?id=@trackingCode"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', @trackingCode);
    </script>
}